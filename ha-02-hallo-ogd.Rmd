---
title: "Hausaufgabe 02 - Hallo Open (Government) Data"
---

<script async defer data-domain="rstatszh.github.io/website" src="https://plausible.io/js/plausible.js"></script>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Das Portal opendata.swiss stellt der Allgemeinheit offene Beh√∂rdendaten in einem zentralen Katalog zur Verf√ºgung. Es wird betrieben vom Bundesamt f√ºr Statisik und ist ein gemeinsames Projekt von Bund, Kantonen, Gemeinden und weiteren Organisationen mit einem staatlichen Auftrag. In dieser Hausaufgabe nutzen wir den Datensatz ["Corona Hilfen im Kulturbereich im Kanton Z√ºrich"](https://opendata.swiss/de/dataset/corona-hilfen-im-kulturbereich-im-kanton-zurich) publiziert am 04. M√§rz 2021 von der Fachstelle Open Government Data des Kantons Z√ºrich, und der Fachstele Kultur der Direktion der Justiz und des Innern. 

# Ziele

Diese Hausaufgabe hat die folgenden Ziele:

- einen OGD Datensatz von opendata.swiss zu erkunden
- Visualisierungen zu rekonstruieren
- Mehr √úbung mit Git und GitHub zu bekommen

# Erste Schritte

√ñffne deine Email Inbox und suche nach der Email mit dem Link f√ºr das GitHub Repo zu dieser Hausaufgabe (ha-02-hallo-ogd). Alternativ kannst du GitHub √∂ffnen und in unserer GitHub Organisation nach dem Repo mit deinem Namen suchen.

Folge den Schritten aus Hausaufgabe 1 oder den Folien der Woche 2 um das GitHub Repo in deine RStudio Cloud zu clonen. 

# Packages

In dieser Hausaufgabe lernst du ein zwei R Packages kennen, welche wir in Woche 3 in mehr Detail behandeln werden. Das `{readr}` und das `{dplyr}` Package, welche beide zur Sammlung der `{tidyverse}` Packages geh√∂ren. 

```{r}

library(ggplot2)
library(dplyr)
library(readr)

```

# Data

Wir nutzen den Datensatz mit dem Titel ["Corona Hilfen im Kulturbereich im Kanton Z√ºrich"](https://opendata.swiss/de/dataset/corona-hilfen-im-kulturbereich-im-kanton-zurich) publiziert am 04. M√§rz 2021 von der Fachstelle Open Government Data des Kantons Z√ºrich, Fachstele Kultur (Direktion der Justiz und des Innern). 

```{r, echo=FALSE}

corona_kultur <- read_csv("https://www.web.statistik.zh.ch/ogd/data/ji/fk/kultur_ausfallentschaedigung.csv")

```

Die Beschreibung der Variablen ist auf der [Ressource f√ºr den Datensatz](https://opendata.swiss/de/dataset/corona-hilfen-im-kulturbereich-im-kanton-zurich/resource/c93b970b-c903-4598-86c5-b7f04032848d) zu finden: 

- **Kategorie** = Antragstellende Kategorie ('Kulturschaffende', 'Kulturunternehmen gemeinn√ºtzig' oder 'Kulturunternehmen gewinnorientiert')
- **Sparte** = Kultursparte ('Bereichs√ºbergreifend', 'Bildende Kunst', 'Design', 'Film', 'Kino', 'Klubs und Konzertlokale', 'Literatur', 'Museen', 'Musik' oder 'Tanz/Theater')
- **Nachgefragt** = Nachgefragter Betrag in CHF (gerundet auf 100 CHF)
- **Beschluss** = Beschlossener Betrag in CHF (gerundet auf 100 CHF, 'NA' bei Ablehnung)
- **Status** = Status des Antrags ('Ablehnung', 'Ausbezahlt' oder 'Saldo offen')
- **Eingangsdatum** = Datum des Eingangs des Gesuchs; 'Beschlussdatum' = Datum des Beschlusses √ºber das Gesuch
- **ID** = anonymisierter Identifikator der antragstellenden nat√ºrlichen oder juristischen Person

# √úbungen 

## √úbung 1

Erinnerst du dich, dass RStudio in vier Bereiche unterteilt ist? Versuche diese, ohne nachzuschauen, zu benennen.

**Aufgaben**

1. F√ºge deine Antworten zu der R Markdown Datei f√ºr die Hausaufgabe hinzu
2. Stricke das Dokument und verifiziere, dass es keine Fehlermeldung gibt

üß∂ ‚úÖ ‚¨ÜÔ∏è *Knit, commit, und pushe deine √Ñnderungen auf GitHub mit der Commit-Nachricht "F√ºge Antwort f√ºr √úbung 1 hinzu." Achte darauf, alle ge√§nderten Dateien zu committen und zu pushen, damit dein Git-Fenster danach aufger√§umt ist.*

## √úbung 2

Verifiziere, dass der Datensatz `corona_kultur` in deinem Environment (Fenster oben rechts) in RStudio zu finden ist. Wieviele Beobachtungen gibt es in diesem Datensatz?

**Aufgaben**

1. Im RStudio Environment, klicke auf den Namen das Datensatzes `corona_kultur`
2. F√ºhre den Code `View(corona_kultur)` in der **Console** aus.
3. Nutze die Funktionen `glimpse()` und `str()` in einem R Code-chunk um die Daten zu erkunden
4. F√ºhre das Objekt `corona_kultur` in der Console aus? Kannst du die Anzahl Reihen und Spalten im Output finden?
5. Welche zwei weiteren Funktionen kennst du um die Anzahl der Reihen und Spalten eines Datensatzes zu erfahren?
6. In der Spalte `Beschluss` taucht immer wieder der Wert 'NA' auf. Was bedeutet dies? Generell, und f√ºr diesen Datensatz?

```{r, include=FALSE}

glimpse(corona_kultur)
str(corona_kultur)

```

üß∂ ‚úÖ ‚¨ÜÔ∏è *Knit, commit, und pushe deine √Ñnderungen auf GitHub mit der Commit-Nachricht "F√ºge Antwort f√ºr √úbung 2  hinzu." Achte darauf, alle ge√§nderten Dateien zu committen und zu pushen, damit dein Git-Fenster danach aufger√§umt ist.*

## √úbung 3

Schauen wir uns zuerst die Verteilung der Betr√§ge an, welche nachgefragt wurden. Wir sehen, dass eine grosse Anzahl an kleineren Betr√§gen (< 100'000 CHF) beantragt wurde, und das einige grosse Betr√§ge (> 2'000'000 CHF) bentragt wurden. Ein Antrag mit √ºber 10 Millionen CHF sticht ganz besonders heraus und f√ºhrt dazu, dass dieser Plot nicht besonders sch√∂n ist. 

**Code vorlesen:** Nutze das Objekt `corona_kultur` und plotte ein Histogram mit der der Verteilung der nachgefragten Betr√§ge auf der x-Achse. Z√§hle die Anzahl der Gesuche pro 100'000 CHF auf der y-Achse. 

```{r}

ggplot(data = corona_kultur, aes(x = Nachgefragt)) +
  geom_histogram(binwidth = 100000)

```


**Code vorlesen:** Beginne mit dem Objekt `corona_kultur` und leite es in die Funktion `filter()`, um nach Beobachtungen zu filtern, bei denen die Variable 'Nachgefragt' gr√∂sser 2'000'000 ist. Ordne den Datensatz dann in absteigender Reihenfolge nach der Variable 'Nachgefragt' 

```{r}

corona_kultur %>% 
  filter(Nachgefragt > 2000000) %>% 
  arrange(desc(Nachgefragt)) 

```

In den folgenden Aufgaben wollen wir uns nur mit Beobachtungen besch√§ftigen bei welchen die Variable 'Beschluss' kleiner 100'000 CHF ist. Dazu wird der Datensatz gefiltert und als ein neues Objekt in dem RStudio Environment gespeichert. Ich habe den Code f√ºr dich vorbereitet.

```{r}

corona_kultur_beschluss_gering <- corona_kultur %>% 
  filter(Beschluss < 100000) 

```

**Aufgaben**

1. Nutze die Daten im Objekt `corona_kultur_beschluss_gering` um mit der Funktion `ggplot()` einen Plot zu erstellen
2. Nutze die Variable 'Beschluss' f√ºr die x-Achse 
3. Nutze das Geom f√ºr ein Histogram f√ºr die Darstellung des Plots (**Tipp:** `geom_histogram`)

**F√ºhre den Code aus und betrachte den Plot**

4. Ordne die Variable 'Sparte' der der visuellen Eigenschaft f√ºr Farben zu (**Tipp:** Schaue in Praktikum 3 oder 4 nach wie du es dort gemacht hast)

**F√ºhre den Code aus und betrachte den Plot**

5. Nutze Faceting und lege die Variable 'Kategorie' auf die Spalten (**Tipp:** Schaue in Praktikum 4 nach wie du es dort gemacht hast)

**F√ºhre den Code aus und betrachte den Plot**

6. Innerhalb der Klammern der Funktion `geom_histogram()`, f√ºge das Argument 'binwidth' hinzu uns setze den Wert auf 10000 (**Tipp**: `binwidth = 10000`). Was bewirkt dieses Argument?

**F√ºhre den Code aus und betrachte den Plot**

7. F√ºge einen Titel, einen Untertitiel und eine Bildunterschrift (caption) hinzu. (**Tipp:** Schaue in den Folien f√ºr Woche 2 nach)

```{r, include=FALSE}

corona_kultur_beschluss_gering %>%
  ggplot(aes(x = Beschluss, fill = Sparte)) +
  geom_histogram(binwidth = 10000) +
  facet_wrap(~Kategorie, ncol = 3) +
  labs(title = "Corona Hilfen im Kulturbereich im Kanton Z√ºrich", 
       subtitle = "Verteilung der Betr√§ge kleiner 100'000 CHF nach Kategorie und Sparte",
       caption = "Daten: opendata.swiss")

```

üß∂ ‚úÖ ‚¨ÜÔ∏è *Knit, commit, und pushe deine √Ñnderungen auf GitHub mit der Commit-Nachricht "F√ºge Antwort f√ºr √úbung 3 hinzu." Achte darauf, alle ge√§nderten Dateien zu committen und zu pushen, damit dein Git-Fenster danach aufger√§umt ist.*

Gratulation! Du hast die √úbungen abgeschlossen. Falls du noch Lust und Zeit hast, ist hier noch eine Bonusaufgabe.

## √úbung 4 (Bonus)

1. Nutze das Objekt `corona_kultur` und erstelle eine S√§ulendiagram (`geom_bar`)
2. Ordne die Variable 'Sparte' der visuellen Eigenschaft f√ºr Farben zu
3. Ordne der x-Achse eine kategoriale Variable 'Status' zu (anstatt einer numerischen Variable 'Beschluss') 
4. Nutze Faceting und lege die Variable 'Kategorie' auf die Spalten
5. F√ºge einen Titel, einen Untertitiel und eine Bildunterschrift (caption) hinzu.
6. √Ñndere die Position der Legende auf den unteren Bereich des Plots (**Tipp:** Schau nach was wir in √úbung 2 aus Praktikum 4 gemacht haben und ersetze 'none' durch 'bottom')

```{r, include=FALSE}


ggplot(data = corona_kultur,
       mapping =  aes(x = Status, 
                      fill = Sparte)) +
  geom_bar() +
  facet_wrap(~Kategorie, nrow = 1) +
  theme(legend.position = "bottom")


```

üß∂ ‚úÖ ‚¨ÜÔ∏è *Knit, commit, und pushe deine √Ñnderungen auf GitHub mit der Commit-Nachricht "F√ºge Antwort f√ºr √úbung 4  hinzu." Achte darauf, alle ge√§nderten Dateien zu committen und zu pushen, damit dein Git-Fenster danach aufger√§umt ist.*

